{%- assign indexNum = 0 | plus : 1 -%}
{%- assign productId = item.url | split : "?" -%}
{%- assign productURL = productId[0] | split : "/" -%}

{%- if prodName == blank -%}
{%- assign category = 'ギフトセット' -%}
{%- endif -%}

{%- assign variant_options = 'template ' | split: ' ' -%}
{%- if item.product.has_only_default_variant != true -%}
  {%- assign variant_options = item.options_with_values -%}
{%- endif -%}
{%- assign property_size = item.properties | size -%}

{% unless item.url contains 'ks004' %}
<div class="cart_item" data-cart-item data-cart-item-key="{{ item.key }}" data-cart-item-url="{{ item.url }}" data-cart-item-title="{{ item.title }}" data-cart-item-index="{{ forloop.index }}" data-cart-item-quantity="{{ item.quantity }}" {% if item.url contains 'kt1040' %}style="order: 1;"{%- endif -%}>
  <div class="img_wrap">
    <a href="{{ productId[0] }}">{{ item.image.src | image_url: width: 300 | image_tag }}</a>
  </div>
  <div class="txt_wrap">
    <div class="txt_inner">
      <div class="item_info">
        {%- if item.product.type == 'gift' -%}
        <span class="category"><span class="ja">ギフトセット</span></span>
        {%- else -%}
        <span class="category"><span class="ja">{{ item.product.metafields.custom_fields["prod_category"] }}</span></span>
        {%- endif -%}
        <a class="links" href="{{ productId[0] }}"><span class="name">{{ item.product.metafields.custom_fields["prod_display_name"] }}</span>{%- for option in variant_options -%}<span class="options genre {% if item.product.has_only_default_variant %} hide{% endif %}" optionName="{{ option.value }}">{{ option.value }}</span>{%- endfor -%}{% if item.selling_plan_allocation %}<span class="options genre">{{ item.selling_plan_allocation.selling_plan.name }}</span>
        {% endif %}</a>

        {%- assign cpPrice = item.variant.compare_at_price | money_without_currency -%}

        {% if cpPrice == blank %}
        <span class="price" cpPrice="{{ cpPrice }}">{{ item.price | money_without_currency }}円(税込)</span></a>
        {%- else -%}
        <span class="price_wrapper" cpPrice="{{ cpPrice }}">
          <span class="price_strike">{{ cpPrice }}円</span>
          <span class="arrow">→</span>
          <span class="price">{{ item.price | money_without_currency }}円(税込)</span>
        </span>
        {%- endif -%}

      </div>
      <div class="controll_wrap">
      {%- if request.page_type contains "customers" -%}
      <div class="fixed_lot">
        <span class="number">{{ item.quantity }}点</span>
      </div>
      {%- else -%}
        <div class="order_lot">
          {% unless item.url contains 'kt1040' %}<button class="order_button minus"><span></span></button>{%- endunless -%}
          <input type="number" name="updates[]" id="updates_{{ item.key }}" data-id="{{ item.key }}" value="{{ item.quantity }}" min="0">
          {% unless item.url contains 'kt1040' %}<button class="order_button plus"><span></span></button>{%- endunless -%}
          <button class="reload_button"></button>
        </div>
          <a class="cancel_button" href="/cart/change?line={{ forloop.index }}&amp;quantity=0" class="text-link text-link--accent" aria-label="{{ 'cart.label.remove' | t: product: item.title }}" data-cart-remove data-role="product-remove">削除</a>
      {%- endif -%}
      </div>
    </div><!-- txt_inner -->
    {%- assign totalPrice = item.price | times : item.quantity -%}
    <div class="amount_price">¥{{ totalPrice | money_without_currency }}</div>
  </div><!-- txt_wrap -->
</div><!-- cart_item -->
{%- else -%}
<div class="cart_item" style="order: 1;">
  <div class="txt_wrap" style="width: 100%;">
    <div class="txt_inner">
      <div class="item_info">
        <a class="links" href="javascript:void(0);">
          <span class="name"><span class="name">お渡し用手提げ紙袋</span></span><span class="options genre  hide" optionname="">ギフトオプション</span>
        </a>
        <span class="price" cpprice="">110円(税込)</span></div>
        <div class="controll_wrap"><div class="order_lot">
          <button class="order_button minus"><span></span></button>
          <input type="number" name="updates[]" id="updates_{{ item.key }}" data-id="{{ item.key }}" value="{{ item.quantity }}" min="0">
          <button class="order_button plus"><span></span></button><button class="reload_button"></button>
        </div>
        <a class="cancel_button" href="/cart/change?line={{ forloop.index }}&amp;quantity=0" class="text-link text-link--accent" aria-label="{{ 'cart.label.remove' | t: product: item.title }}" data-cart-remove data-role="product-remove">削除</a>
      </div>
    </div><!-- txt_inner --><div class="amount_price">¥110</div>
  </div><!-- txt_wrap -->
</div>
{%- endunless -%}
